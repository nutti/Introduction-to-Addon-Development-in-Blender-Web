<div id="sect_title_img_5_1"></div>

<div id="sect_title_text"></div>

# キーボードによるオブジェクト変形

<div id="preface"></div>

###### 　


<div id="space_s"></div>


本節では、キーボードのキー入力に応じて選択されているオブジェクトを並進移動・拡大縮小・回転するアドオンを紹介します。アドオンの機能自体は、[3-2節](../chapter_03/02_Handle_Keyboard_Key_Event.md)や[3-10節](../chapter_03/10_Use_User_Preference.md)で説明したサンプルをベースに作りましたが、様々な処理を追加したために完全に異なるアドオンになっています。


## アドオンのソースコード

本節で紹介するアドオンは、[はじめに](../../README.md)の『本書で紹介するサンプルのソースコードについて』に記載したサンプルアドオンのダウンロード先から、ダウンロードできます。```chapter_05/sample_5_1.py``` を探してダウンロードしてください。


## 関連する箇所

本節のサンプルに使われているAPIについて説明している箇所は、次の通りです。細かいところも含めると他の箇所も関係していますが、ここでは特に関連が深い箇所に絞って記載します。

* [2-1. アドオン開発の基礎を身につける](../chapter_02/01_Basic_of_Add-on_Development.md)
  * 基本的なアドオンの作り方
* [2-8. BlenderのUIを制御する①](../chapter_02/08_Control_Blender_UI_1.md)
  * ```poll()``` メソッドの扱い方
* [3-1. マウスクリックのイベントを扱う](../chapter_03/01_Handle_Mouse_Click_Event.md)
  * プロパティパネルにおけるUI構築
* [3-2. キーボードのキーイベントを扱う](../chapter_03/02_Handle_Keyboard_Key_Event.md)
  * キーボードのキーイベントの扱い方
* [3-6. オーディオファイルを再生する](../chapter_03/06_Play_Audio_File.md)
  * プロパティの値を変更した時に処理を実行する方法
* [3-10. ユーザー・プリファレンスを活用する](../chapter_03/10_Use_User_Preference.md)
  * ユーザー・プリファレンスにアドオン設定情報を配置する方法


## アドオンの仕様

* *3Dビュー* エリアのプロパティパネルの項目 *特殊オブジェクト編集モード* に、特殊オブジェクト編集モードを開始/終了するためのボタンを配置する
  * オブジェクトモード時、かつ最低でも1個のオブジェクトが選択されている場合のみ、プロパティパネルに項目を表示する
* 特殊オブジェクト編集モード時は、ユーザー・プリファレンスで設定したキーを押したときに、オブジェクトに対して処理を行うことができる
  * デフォルトでは、下表に示されたキーを押したときに、オブジェクトに対して該当する処理を行うことができる
  * 特殊オブジェクト編集モード時に、処理に関連する値（移動量・拡大率・縮小率・回転量）を設定することができる
  * オブジェクトの変形操作の結果は、*3Dビュー* エリアのメニュー *オブジェクト* > *トランスフォーム* > *移動* 、*オブジェクト* > *トランスフォーム* > *回転* *オブジェクト* > *トランスフォーム* > *拡大縮小* を実行したときに行われる、オブジェクト変形処理と同じである
* キーボードのキー *Q* が押された時は、特殊オブジェクト編集モードを終了する
* 特殊オブジェクト編集モードにおいて使用するキーは、ユーザー・プリファレンスのアドオン設定から選択できる
  * *Q* キーは特殊なキーとして扱い、特殊オブジェクト編集モードにおいて使用するキーとして設定することはできない
  * 複数の操作に対して同じキーを割り当てることはできない


|キー|処理|
|---|---|
|*T* + *X* + *→*|X軸正方向に平行移動|
|*T* + *X* + *←*|X軸負方向に平行移動|
|*T* + *Y* + *→*|Y軸正方向に平行移動|
|*T* + *Y* + *←*|Y軸負方向に平行移動|
|*T* + *Z* + *→*|Z軸正方向に平行移動|
|*T* + *Z* + *←*|Z軸負方向に平行移動|
|*S* + *X* + *→*|X軸方向に拡大|
|*S* + *X* + *←*|X軸方向に縮小|
|*S* + *Y* + *→*|Y軸方向に拡大|
|*S* + *Y* + *←*|Y軸方向に縮小|
|*S* + *Z* + *→*|Z軸方向に拡大|
|*S* + *Z* + *←*|Z軸方向に縮小|
|*R* + *X* + *→*|X軸周りの正方向に回転|
|*R* + *X* + *←*|X軸周りの負方向に回転|
|*R* + *Y* + *→*|Y軸周りの正方向に回転|
|*R* + *Y* + *←*|Y軸周りの負方向に回転|
|*R* + *Z* + *→*|Z軸周りの正方向に回転|
|*R* + *Z* + *←*|Z軸周りの負方向に回転|


### アドオンの機能を使用する

次の手順に従って、アドオンの動作を確認します。


<div id="process_title"></div>

##### Work

<div id="process"></div>

|<div id="box">1</div>|ユーザー・プリファンレンスのアドオンの設定から、特殊オブジェクト編集モード時の処理に割り当てるキーを変更します。|![キーボードによるオブジェクト変形 手順1](https://dl.dropboxusercontent.com/s/w4ygf0nti8cptnv/use_add-on_1.png "キーボードによるオブジェクト変形 手順1")|
|---|---|---|

<div id="process_sep"></div>

---

<div id="process"></div>

|<div id="box">2</div>|*3Dビュー* エリアのプロパティパネルの項目 *特殊オブジェクト編集モード* に配置されている、*開始* ボタンをクリックします。|![キーボードによるオブジェクト変形 手順2](https://dl.dropboxusercontent.com/s/297pas1oi809otk/use_add-on_2.png "キーボードによるオブジェクト変形 手順2")|
|---|---|---|

<div id="process_sep"></div>

---

<div id="process"></div>

|<div id="box">3</div>|手順1で割り当てたキーを押し、特殊オブジェクト編集モード中にキーに割り当てた処理が実行されることを確認します。|![キーボードによるオブジェクト変形 手順3](https://dl.dropboxusercontent.com/s/0oekokrdu9t0hg5/use_add-on_3.png "キーボードによるオブジェクト変形 手順3")|
|---|---|---|

<div id="process_sep"></div>

---

<div id="process"></div>

|<div id="box">4</div>|*3Dビュー* エリアのプロパティパネルの項目 *特殊オブジェクト編集モード* から、各処理の移動量・拡大率・縮小率・回転量を指定することができます。|![キーボードによるオブジェクト変形 手順4](https://dl.dropboxusercontent.com/s/62ieg49p4b2nz46/use_add-on_4.png "キーボードによるオブジェクト変形 手順4")|
|---|---|---|

<div id="process_sep"></div>

---

<div id="process"></div>

|<div id="box">5</div>|*Q* キー押すか、プロパティパネルの項目 *特殊オブジェクト編集モード* に配置されている *終了* ボタンを押すと、特殊オブジェクト編集モードを終了します。|![キーボードによるオブジェクト変形 手順5](https://dl.dropboxusercontent.com/s/ia65dxpnie7p5sc/use_add-on_5.png "キーボードによるオブジェクト変形 手順5")|
|---|---|---|


<div id="process_start_end"></div>

---

<div id="space_page"></div>
