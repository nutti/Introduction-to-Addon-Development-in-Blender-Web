<div id="sect_title_img_3_9"></div>

<div id="sect_title_text"></div>

# アドオンの設定を活用する

<div id="preface"></div>

###### ユーザはアドオンごとに提供される設定を変更することができます。アドオンの設定を活用することで、アドオンで使用するキーボードのキーやUIのフォントなど、ユーザ自身に設定させたい情報を扱うことができます。本節では、ユーザからアドオンを設定できるようにするための方法を説明します。


## アドオンの設定

アドオンの設定の説明に入る前に、アドオンの設定をどこで参照＆設定することができるのかを知っておく必要があります。ここでは、筆者が作成したアドオン『Magic UV』を使って確認します。アドオン『Magic UV』は、https://github.com/nutti/Magic-UV/releases/download/v4.0/uv_magic_uv.zip からダウンロードすることができます。


<div id="process_title"></div>

##### Work

<div id="process_noimg"></div>

|<div id="box">1</div>|[1-4節](../chapter_01/04_Understand_Install_Uninstall_Update_Add-on.md) に従ってアドオンをインストールします。|
|---|---|

<div id="process_sep"></div>

---

<div id="process"></div>

|<div id="box">2</div>|*情報* エリアの *ファイル* > *ユーザ設定...* を実行して表示されるウィンドウで *アドオン* タブを選択し、『Magic UV』を有効化した状態で左の矢印をクリックしてアドオンの詳細情報を表示します。||
|---|---|---|

<div id="process_sep"></div>

---

<div id="process"></div>

|<div id="box">3</div>|*ユーザ設定:* と書かれた場所が、アドオンの設定画面を示しています。||
|---|---|---|

<div id="process_sep"></div>

---


<div id="process_start_end"></div>

---


## アドオンの設定として追加すべき項目

これまで説明してきたように、ユーザがアドオンの動作を変更するための設定UIはツール・シェルフやプロパティパネルに配置してもよいですが、全てのアドオン設定を配置することはUIが煩雑になるため良いとは言えません。ツール・シェルフやプロパティパネルに配置する設定情報は頻繁に変更する設定のみとし、その他はアドオンの設定に配置するなどして使い分けた方が良いです。アドオンの設定として追加すべき項目の例を以下に示します。

* アドオン内の機能の有効化/無効化
* アドオンの機能に割り当てたショートカットキー
* フォントなどのアドオンのUI設定
* ```bl_info``` で記載できなかったアドオンの詳細情報（```location``` や ```description```）
* アドオン全体で共有したい設定

## 作成するアドオンの仕様

* [3-2節](02_Handle_Keyboard_Key_Event.md) のサンプルを改造し、使用するキーをアドオンのユーザ設定から選択できるようにする


## アドオンを作成する

[1-5節](../chapter_01/05_Install_own_Add-on.md) を参考にして以下のソースコードをテキスト・エディタに入力し、ファイル名 ```sample_3-9.py``` として保存してください。

[import](../../sample/src/chapter_03/sample_3-9.py)

## アドオンを使用する

### アドオンを有効化する

[1-5節](../chapter_01/05_Install_own_Add-on.md) を参考に作成したアドオンを有効化すると、コンソールウィンドウに文字列が出力されます。

```sh
サンプル3-9: アドオン「サンプル3-9」が有効化されました。
```

<div id="sidebyside"></div>

|アドオンを有効化すると、右図のようにアドオンの設定が表示されます。||
|---|---|



### アドオンの機能を使用する

以下の手順に従って、作成したアドオンの機能を使ってみます。


<div id="process_title"></div>

##### Work

<div id="process"></div>

|<div id="box">1</div>|アドオンの設定から、機能に割り当てられているキーを変更します。||
|---|---|---|

<div id="process_sep"></div>

---

<div id="process"></div>

|<div id="box">2</div>|[3-2節](02_Handle_Keyboard_Key_Event.md) の機能が、1で割り当てたキーで動作することを確認します。||
|---|---|---|

<div id="process_sep"></div>

---



<div id="process_start_end"></div>

---


### アドオンを無効化する

[1-5節](../chapter_01/05_Install_own_Add-on.md) を参考に有効化したアドオンを無効化すると、コンソールウィンドウに文字列が出力されます。

```sh
サンプル3-9: アドオン「サンプル3-9」が無効化されました。
```



## ソースコードの解説

ユーザからアドオンの設定を行い、アドオンの動作に反映させるためには以下の処理を実装する必要があります。

1. アドオン設定クラスを定義する
2. アドオン設定クラスに定義した設定情報を取得する

### アドオン設定クラスを定義する

アドオンの設定情報 ```bpy.types.AddonPreferences``` クラスを継承したアドオン設定クラスを定義する必要があります。


## まとめ




<div id="point"></div>

### ポイント

<div id="point_item"></div>

*
